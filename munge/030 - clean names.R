library(tidyverse)
df <- read_csv("data/processed/wnv.trap.date.rev3b.csv")
df = df %>%
    rename(
        t_date = date,
        t_yr = yr,
        t_mo = mo,
        t_day = day,
        t_qtr = qtr,
        t_wk = wk,
        t_day.of.yr = day.of.yr,
        t_day.of.wk = day.of.wk,
        t_day.of.wk.name = day.of.wk.name,
        t_eval.day = eval.day,
        t_eval.wk = eval.wk,
        part_train = train,
        part_validate = validate,
        part_test = test,
        part_partition = partition,
        trap_trap.name = trap.name,
        loc_lat = lat,
        loc_lng = lng,
        loc_lat.lng.src = lat.lng.src,
        trap_satellite.ind = satellite.ind,
        loc_zipcode = ZCTA5CE10,
        loc_census_block_group_id = BlkGrp.geoid,
        loc_census_tract_id = Tract.geoid,
        loc_community = community,
        zone_class = zone_class,
        zone_type = zone_type,
        ses_LT_HS_pct__BlkGrp2017 = LT_HS_pct__BlkGrp2017,
        ses_median_HHInc__BlkGrp2017 = median_HHInc__BlkGrp2017,
        ses_LT_Pov_pct__BlkGrp2017 = LT_Pov_pct__BlkGrp2017,
        ses_LT_HS_pct__Tract2017 = LT_HS_pct__Tract2017,
        ses_median_HHInc__Tract2017 = median_HHInc__Tract2017,
        ses_LT_Pov_pct__Tract2017 = LT_Pov_pct__Tract2017,
        trap_trap_type = trap_type,
        mos_erraticus.NumMosquitos = erraticus.NumMosquitos,
        mos_pipiens.NumMosquitos = pipiens.NumMosquitos,
        mos_pipiens_restuans.NumMosquitos = pipiens_restuans.NumMosquitos,
        mos_restuans.NumMosquitos = restuans.NumMosquitos,
        mos_salinarius.NumMosquitos = salinarius.NumMosquitos,
        mos_tarsalis.NumMosquitos = tarsalis.NumMosquitos,
        mos_territans.NumMosquitos = territans.NumMosquitos,
        mos_unspecified.NumMosquitos = unspecified.NumMosquitos,
        mos_tot.NumMosquitos = tot.NumMosquitos,
        mos_erraticus.WnvPresent = erraticus.WnvPresent,
        mos_pipiens.WnvPresent = pipiens.WnvPresent,
        mos_pipiens_restuans.WnvPresent = pipiens_restuans.WnvPresent,
        mos_restuans.WnvPresent = restuans.WnvPresent,
        mos_salinarius.WnvPresent = salinarius.WnvPresent,
        mos_tarsalis.WnvPresent = tarsalis.WnvPresent,
        mos_territans.WnvPresent = territans.WnvPresent,
        mos_unspecified.WnvPresent = unspecified.WnvPresent,
        mos_any.WnvPresent = any.WnvPresent,
        nbrhud_comm.180d.violation.cnt = comm.180d.violation.cnt,
        nbrhud_BlkGrp.180d.violation.cnt = BlkGrp.180d.violation.cnt,
        nbrhud_zipcode.180d.violation.cnt = zcta.180d.violation.cnt,
        nbrhud_comm.180d.vacancies.cnt = comm.180d.vacancies.cnt,
        nbrhud_BlkGrp.180d.vacancies.cnt = BlkGrp.180d.vacancies.cnt,
        nbrhud_zipcode.180d.vacancies.cnt = zcta.180d.vacancies.cnt,
        wea_midway_PRCP = USW00014819_PRCP,
        wea_midway_tavg2 = USW00014819_tavg2,
        wea_midway_TMAX = USW00014819_TMAX,
        wea_midway_TMIN = USW00014819_TMIN,
        wea_ohare_PRCP = USW00094846_PRCP,
        wea_ohare_tavg2 = USW00094846_tavg2,
        wea_ohare_TMAX = USW00094846_TMAX,
        wea_ohare_TMIN = USW00094846_TMIN,
        wea_midway_tavg2.ma7 = USW00014819_tavg2.ma7,
        wea_ohare_tavg2.ma7 = USW00094846_tavg2.ma7,
        wea_midway_tavg2.ma60 = USW00014819_tavg2.ma60,
        wea_ohare_tavg2.ma60 = USW00094846_tavg2.ma60,
        wea_midway_PRCP.sum7 = USW00014819_PRCP.sum7,
        wea_ohare_PRCP.sum7 = USW00094846_PRCP.sum7,
        wea_midway_PRCP.sum60 = USW00014819_PRCP.sum60,
        wea_ohare_PRCP.sum60 = USW00094846_PRCP.sum60,
        wea_midway_PRCP.sum60.lag7 = USW00014819_PRCP.sum60.lag7,
        wea_midway_PRCP.sum60.lag14 = USW00014819_PRCP.sum60.lag14,
        wea_midway_PRCP.sum60.lag21 = USW00014819_PRCP.sum60.lag21,
        wea_midway_PRCP.sum60.lag28 = USW00014819_PRCP.sum60.lag28,
        wea_midway_PRCP.sum60.lag35 = USW00014819_PRCP.sum60.lag35,
        wea_midway_PRCP.sum60.lag42 = USW00014819_PRCP.sum60.lag42,
        wea_midway_PRCP.sum60.lag49 = USW00014819_PRCP.sum60.lag49,
        wea_midway_PRCP.sum60.lag56 = USW00014819_PRCP.sum60.lag56,
        wea_midway_PRCP.sum60.lag63 = USW00014819_PRCP.sum60.lag63,
        wea_midway_PRCP.sum60.lag90 = USW00014819_PRCP.sum60.lag90,
        wea_midway_PRCP.sum60.lag120 = USW00014819_PRCP.sum60.lag120,
        wea_midway_tavg2.ma60.lag7 = USW00014819_tavg2.ma60.lag7,
        wea_midway_tavg2.ma60.lag14 = USW00014819_tavg2.ma60.lag14,
        wea_midway_tavg2.ma60.lag21 = USW00014819_tavg2.ma60.lag21,
        wea_midway_tavg2.ma60.lag28 = USW00014819_tavg2.ma60.lag28,
        wea_midway_tavg2.ma60.lag35 = USW00014819_tavg2.ma60.lag35,
        wea_midway_tavg2.ma60.lag42 = USW00014819_tavg2.ma60.lag42,
        wea_midway_tavg2.ma60.lag49 = USW00014819_tavg2.ma60.lag49,
        wea_midway_tavg2.ma60.lag56 = USW00014819_tavg2.ma60.lag56,
        wea_midway_tavg2.ma60.lag63 = USW00014819_tavg2.ma60.lag63,
        wea_midway_tavg2.ma60.lag90 = USW00014819_tavg2.ma60.lag90,
        wea_midway_tavg2.ma60.lag120 = USW00014819_tavg2.ma60.lag120,
        wea_ohare_PRCP.sum60.lag7 = USW00094846_PRCP.sum60.lag7,
        wea_ohare_PRCP.sum60.lag14 = USW00094846_PRCP.sum60.lag14,
        wea_ohare_PRCP.sum60.lag21 = USW00094846_PRCP.sum60.lag21,
        wea_ohare_PRCP.sum60.lag28 = USW00094846_PRCP.sum60.lag28,
        wea_ohare_PRCP.sum60.lag35 = USW00094846_PRCP.sum60.lag35,
        wea_ohare_PRCP.sum60.lag42 = USW00094846_PRCP.sum60.lag42,
        wea_ohare_PRCP.sum60.lag49 = USW00094846_PRCP.sum60.lag49,
        wea_ohare_PRCP.sum60.lag56 = USW00094846_PRCP.sum60.lag56,
        wea_ohare_PRCP.sum60.lag63 = USW00094846_PRCP.sum60.lag63,
        wea_ohare_PRCP.sum60.lag90 = USW00094846_PRCP.sum60.lag90,
        wea_ohare_PRCP.sum60.lag120 = USW00094846_PRCP.sum60.lag120,
        wea_ohare_tavg2.ma60.lag7 = USW00094846_tavg2.ma60.lag7,
        wea_ohare_tavg2.ma60.lag14 = USW00094846_tavg2.ma60.lag14,
        wea_ohare_tavg2.ma60.lag21 = USW00094846_tavg2.ma60.lag21,
        wea_ohare_tavg2.ma60.lag28 = USW00094846_tavg2.ma60.lag28,
        wea_ohare_tavg2.ma60.lag35 = USW00094846_tavg2.ma60.lag35,
        wea_ohare_tavg2.ma60.lag42 = USW00094846_tavg2.ma60.lag42,
        wea_ohare_tavg2.ma60.lag49 = USW00094846_tavg2.ma60.lag49,
        wea_ohare_tavg2.ma60.lag56 = USW00094846_tavg2.ma60.lag56,
        wea_ohare_tavg2.ma60.lag63 = USW00094846_tavg2.ma60.lag63,
        wea_ohare_tavg2.ma60.lag90 = USW00094846_tavg2.ma60.lag90,
        wea_ohare_tavg2.ma60.lag120 = USW00094846_tavg2.ma60.lag120
    ) %>%
    janitor::clean_names()

df %>% write_csv("data/processed/wnv.trap.date.rev3b.csv")
df %>% save(file = "data/processed/wnv.trap.date.rev3b.RData")
